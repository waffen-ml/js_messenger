extends index

append script 
    include js/chatlist.js

append style
    include css/chatlist.css

mixin chat(data)
    - const displayedName = data.privateName ?? data.obj.name;
    a(href=`chat?id=${data.id}`)= displayedName

block main
    h1.page-header –°–æ–æ–±—â–µ–Ω–∏—è
    ul.chatlist
        each view in views
            if view.visible
                - let cls = (view.voice? 'voice' : '') + ' ' + (view.unread? 'unread' : '')
                li.block.chat(chatid=view.chat_id, class=cls)
                    img.avatar(src="/file?id=169904737598173031.jpg")
                    span.finite.title= view.chat_name
                    span.datetime= view.datetime_label 
                    p.finite.last-msg-preview= (view.lm_sender_id==user.id? '–í—ã: ' : view.lm_sender_name + ': ') + view.lm_preview
                    a.button.dots ...
                    .event-icons 
                        span.new-msg(text=view.unread)
                        span.call(text="üìû")
